name: generic-sse-transmitter
description: Transmits Security Event Tokens (SET) for CAEP and other security events
version: 1.0.0
runtime: nodejs-22
type: set-transmitter

# Input parameters for web form generation
inputs:
  type:
    type: text
    description: Security event type URI (e.g., https://schemas.openid.net/secevent/caep/event-type/session-revoked)
    required: true
    validation:
      min: 1
      max: 500
      regex: ^https?://.*

  audience:
    type: text
    description: Intended recipient of the SET (e.g., https://customer.okta.com/)
    required: true
    validation:
      min: 1
      max: 500

  subject:
    type: text
    description: Subject identifier JSON (simple or complex format)
    required: true
    validation:
      min: 1
      max: 2000

  eventPayload:
    type: object
    description: Event-specific payload data
    required: true

  address:
    type: text
    description: Optional destination URL override (defaults to ADDRESS environment variable)
    required: false
    validation:
      max: 500
      regex: ^https?://.*

  addressSuffix:
    type: text
    description: Optional suffix to append to the address
    required: false
    validation:
      max: 100

  customClaims:
    type: object
    description: Optional custom claims to add to the JWT
    required: false

  subjectFormat:
    type: text
    description: Subject format (SubjectInEventClaims for CAEP 2.0/Okta events, SubjectInSubId for CAEP 3.0)
    required: false
    validation:
      enum: ["SubjectInEventClaims", "SubjectInSubId"]

# Expected output structure
outputs:
  status:
    type: text
    description: Transmission status ('success' or 'failed')

  statusCode:
    type: number
    description: HTTP status code from the SET receiver

  body:
    type: text
    description: Response body from the SET receiver

  retryable:
    type: boolean
    description: Whether the error is retryable (for failed requests)
